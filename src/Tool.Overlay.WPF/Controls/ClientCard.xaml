<UserControl x:Class="PixelAutomation.Tool.Overlay.WPF.Controls.ClientCard"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    
    <UserControl.Resources>
        <Style x:Key="SectionHeaderStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="#ffffff"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Margin" Value="0,10,0,5"/>
        </Style>
        
        <Style x:Key="LabelStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="#cccccc"/>
            <Setter Property="FontSize" Value="10"/>
            <Setter Property="Margin" Value="0,2"/>
        </Style>
        
        <Style x:Key="ValueStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="#90EE90"/>
            <Setter Property="FontFamily" Value="Consolas"/>
            <Setter Property="FontSize" Value="10"/>
            <Setter Property="FontWeight" Value="Bold"/>
        </Style>
        
        <Style x:Key="CoordTextBoxStyle" TargetType="TextBox">
            <Setter Property="Width" Value="45"/>
            <Setter Property="Height" Value="22"/>
            <Setter Property="Background" Value="#383838"/>
            <Setter Property="Foreground" Value="#ffffff"/>
            <Setter Property="BorderBrush" Value="#555555"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="FontFamily" Value="Consolas"/>
            <Setter Property="FontSize" Value="9"/>
            <Setter Property="TextAlignment" Value="Center"/>
            <Setter Property="Margin" Value="2,1"/>
        </Style>
        
        <Style x:Key="SmallButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#0e639c"/>
            <Setter Property="Foreground" Value="#ffffff"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FontSize" Value="9"/>
            <Setter Property="Height" Value="20"/>
            <Setter Property="Padding" Value="4,2"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#1177bb"/>
                </Trigger>
            </Style.Triggers>
        </Style>
    </UserControl.Resources>
    
    <Border Background="#2d2d30" BorderBrush="#3f3f46" BorderThickness="1" CornerRadius="5" Margin="5" Padding="8">
        <TabControl Background="Transparent" BorderThickness="0">
            <TabControl.Resources>
                <Style TargetType="TabItem">
                    <Setter Property="Background" Value="#3c3c3c"/>
                    <Setter Property="Foreground" Value="#ffffff"/>
                    <Setter Property="BorderThickness" Value="0"/>
                    <Setter Property="Padding" Value="8,4"/>
                    <Setter Property="Margin" Value="0,0,2,0"/>
                    <Setter Property="FontSize" Value="10"/>
                    <Style.Triggers>
                        <Trigger Property="IsSelected" Value="True">
                            <Setter Property="Background" Value="#007acc"/>
                        </Trigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Background" Value="#555555"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </TabControl.Resources>
            
            <TabItem Header="🎮 Main">
                <StackPanel>
            <!-- Client Header -->
            <Grid Margin="0,0,0,8">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0">
                    <TextBlock x:Name="ClientNameText" Text="Client 1" Style="{StaticResource SectionHeaderStyle}" FontSize="14" Margin="0,0,0,2"/>
                    <TextBlock x:Name="WindowTitleText" Text="No window selected" Style="{StaticResource LabelStyle}" FontSize="9" Foreground="#888888"/>
                </StackPanel>
                
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <Button Content="🎯" Width="25" Height="25" Style="{StaticResource SmallButtonStyle}" Click="SelectWindow_Click" ToolTip="Select Window" Margin="0,0,2,0"/>
                    <Ellipse x:Name="StatusIndicator" Width="12" Height="12" Fill="#dc3545" VerticalAlignment="Center" ToolTip="Disconnected"/>
                </StackPanel>
            </Grid>
            
            <!-- HP Probe Section -->
            <Border Background="#1a1a1a" CornerRadius="3" Padding="6" Margin="0,0,0,5" Visibility="Collapsed">
                <StackPanel>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="❤️ HP Probe" Style="{StaticResource SectionHeaderStyle}" FontSize="11" Margin="0,0,0,3"/>
                        <Button Grid.Column="1" Content="🎯 Show Shapes" Style="{StaticResource SmallButtonStyle}" Click="ShowDraggableShapes_Click" Width="80" Margin="0,0,5,0" FontSize="8"/>
                        <CheckBox Grid.Column="2" x:Name="HpTriggerEnabled" Content="Enable" IsChecked="False" Foreground="#cccccc" FontSize="9"/>
                    </Grid>
                    
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="40"/>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <TextBlock Grid.Column="0" Text="Pos:" Style="{StaticResource LabelStyle}" VerticalAlignment="Center"/>
                        <TextBox Grid.Column="1" x:Name="HpX" Style="{StaticResource CoordTextBoxStyle}" Text="0"/>
                        <TextBox Grid.Column="2" x:Name="HpY" Style="{StaticResource CoordTextBoxStyle}" Text="0"/>
                        <TextBox Grid.Column="3" x:Name="HpTolerance" Style="{StaticResource CoordTextBoxStyle}" Text="70" ToolTip="HP % threshold (e.g. 70 = trigger below 70%)"/>
                        <StackPanel Grid.Column="4" Orientation="Horizontal" Margin="5,0,0,0">
                            <Button Content="📍 Pick" Style="{StaticResource SmallButtonStyle}" Click="PickHpCoord_Click" Width="35" Margin="0,0,2,0"/>
                            <Button Content="🎨 Read" Style="{StaticResource SmallButtonStyle}" Click="ReadHpColor_Click" Width="40"/>
                        </StackPanel>
                    </Grid>
                    
                    <Grid Margin="0,3,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="40"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="60"/>
                        </Grid.ColumnDefinitions>
                        
                        <TextBlock Grid.Column="0" Text="Color:" Style="{StaticResource LabelStyle}" VerticalAlignment="Center"/>
                        <Rectangle Grid.Column="1" x:Name="HpColorDisplay" Height="18" Fill="#FF0000" Stroke="#555555" StrokeThickness="1" Margin="0,0,5,0"/>
                        <TextBlock Grid.Column="2" x:Name="HpColorText" Text="255,0,0" Style="{StaticResource ValueStyle}" VerticalAlignment="Center" FontSize="8"/>
                    </Grid>
                    
                    <Grid Margin="0,3,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="40"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <TextBlock Grid.Column="0" Text="HP%:" Style="{StaticResource LabelStyle}" VerticalAlignment="Center"/>
                        <TextBlock Grid.Column="1" x:Name="HpPercentageText" Text="100%" Style="{StaticResource ValueStyle}" VerticalAlignment="Center" FontWeight="Bold" Foreground="#00FF00"/>
                    </Grid>
                    
                    <Grid Margin="0,3,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="40"/>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <TextBlock Grid.Column="0" Text="Pota:" Style="{StaticResource LabelStyle}" VerticalAlignment="Center"/>
                        <TextBox Grid.Column="1" x:Name="HpTriggerX" Style="{StaticResource CoordTextBoxStyle}" Text="0" ToolTip="HP Potion Click X"/>
                        <TextBox Grid.Column="2" x:Name="HpTriggerY" Style="{StaticResource CoordTextBoxStyle}" Text="0" ToolTip="HP Potion Click Y"/>
                        <TextBox Grid.Column="3" x:Name="HpTriggerCooldown" Style="{StaticResource CoordTextBoxStyle}" Text="120" ToolTip="Cooldown ms"/>
                        <Button Grid.Column="4" Content="📍" Style="{StaticResource SmallButtonStyle}" Click="PickHpTrigger_Click" HorizontalAlignment="Left" Width="25" Margin="5,0,0,0"/>
                    </Grid>
                </StackPanel>
            </Border>
            
            <!-- MP Probe Section -->
            <Border Background="#1a1a1a" CornerRadius="3" Padding="6" Margin="0,0,0,5" Visibility="Collapsed">
                <StackPanel>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="💙 MP Probe" Style="{StaticResource SectionHeaderStyle}" FontSize="11" Margin="0,0,0,3"/>
                        <CheckBox Grid.Column="1" x:Name="MpTriggerEnabled" Content="Enable" IsChecked="False" Foreground="#cccccc" FontSize="9"/>
                    </Grid>
                    
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="40"/>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <TextBlock Grid.Column="0" Text="Pos:" Style="{StaticResource LabelStyle}" VerticalAlignment="Center"/>
                        <TextBox Grid.Column="1" x:Name="MpX" Style="{StaticResource CoordTextBoxStyle}" Text="0"/>
                        <TextBox Grid.Column="2" x:Name="MpY" Style="{StaticResource CoordTextBoxStyle}" Text="0"/>
                        <TextBox Grid.Column="3" x:Name="MpTolerance" Style="{StaticResource CoordTextBoxStyle}" Text="50" ToolTip="MP % threshold (e.g. 50 = trigger below 50%)"/>
                        <StackPanel Grid.Column="4" Orientation="Horizontal" Margin="5,0,0,0">
                            <Button Content="📍 Pick" Style="{StaticResource SmallButtonStyle}" Click="PickMpCoord_Click" Width="35" Margin="0,0,2,0"/>
                            <Button Content="🎨 Read" Style="{StaticResource SmallButtonStyle}" Click="ReadMpColor_Click" Width="40"/>
                        </StackPanel>
                    </Grid>
                    
                    <Grid Margin="0,3,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="40"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="60"/>
                        </Grid.ColumnDefinitions>
                        
                        <TextBlock Grid.Column="0" Text="Color:" Style="{StaticResource LabelStyle}" VerticalAlignment="Center"/>
                        <Rectangle Grid.Column="1" x:Name="MpColorDisplay" Height="18" Fill="#0000FF" Stroke="#555555" StrokeThickness="1" Margin="0,0,5,0"/>
                        <TextBlock Grid.Column="2" x:Name="MpColorText" Text="0,0,255" Style="{StaticResource ValueStyle}" VerticalAlignment="Center" FontSize="8"/>
                    </Grid>
                    
                    <Grid Margin="0,3,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="40"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <TextBlock Grid.Column="0" Text="MP%:" Style="{StaticResource LabelStyle}" VerticalAlignment="Center"/>
                        <TextBlock Grid.Column="1" x:Name="MpPercentageText" Text="100%" Style="{StaticResource ValueStyle}" VerticalAlignment="Center" FontWeight="Bold" Foreground="#0088FF"/>
                    </Grid>
                    
                    <Grid Margin="0,3,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="40"/>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <TextBlock Grid.Column="0" Text="Pota:" Style="{StaticResource LabelStyle}" VerticalAlignment="Center"/>
                        <TextBox Grid.Column="1" x:Name="MpTriggerX" Style="{StaticResource CoordTextBoxStyle}" Text="0" ToolTip="MP Potion Click X"/>
                        <TextBox Grid.Column="2" x:Name="MpTriggerY" Style="{StaticResource CoordTextBoxStyle}" Text="0" ToolTip="MP Potion Click Y"/>
                        <TextBox Grid.Column="3" x:Name="MpTriggerCooldown" Style="{StaticResource CoordTextBoxStyle}" Text="120" ToolTip="Cooldown ms"/>
                        <Button Grid.Column="4" Content="📍" Style="{StaticResource SmallButtonStyle}" Click="PickMpTrigger_Click" HorizontalAlignment="Left" Width="25" Margin="5,0,0,0"/>
                    </Grid>
                </StackPanel>
            </Border>
            
            <!-- Python-Style HP/MP Percentage Monitoring Section -->
            <Border Background="#0d4f3c" CornerRadius="3" Padding="6" Margin="0,0,0,5" Visibility="Collapsed">
                <StackPanel>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="🎯 Python-Style HP/MP %" Style="{StaticResource SectionHeaderStyle}" FontSize="11" Margin="0,0,0,3" Foreground="#90EE90"/>
                        <CheckBox Grid.Column="1" x:Name="PercentageMonitoringEnabled" Content="Enable" IsChecked="False" Foreground="#cccccc" FontSize="9"/>
                    </Grid>
                    
                    <!-- HP Percentage Bar -->
                    <Grid Margin="0,3,0,5">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="30"/>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <TextBlock Grid.Column="0" Text="❤️HP:" Style="{StaticResource LabelStyle}" VerticalAlignment="Center" FontWeight="Bold" Foreground="#FF6B6B"/>
                        <TextBox Grid.Column="1" x:Name="HpPercentageStartX" Style="{StaticResource CoordTextBoxStyle}" Text="100" ToolTip="HP Bar Start X"/>
                        <TextBox Grid.Column="2" x:Name="HpPercentageEndX" Style="{StaticResource CoordTextBoxStyle}" Text="250" ToolTip="HP Bar End X"/>
                        <TextBox Grid.Column="3" x:Name="HpPercentageY" Style="{StaticResource CoordTextBoxStyle}" Text="67" ToolTip="HP Bar Y"/>
                        <TextBox Grid.Column="4" x:Name="HpPercentageThreshold" Style="{StaticResource CoordTextBoxStyle}" Text="50" ToolTip="Trigger below this %"/>
                        <TextBox Grid.Column="5" x:Name="HpPercentageTolerance" Style="{StaticResource CoordTextBoxStyle}" Text="30" ToolTip="Color tolerance"/>
                        <StackPanel Grid.Column="6" Orientation="Horizontal" Margin="5,0,0,0">
                            <Button Content="📏" Style="{StaticResource SmallButtonStyle}" Click="PickHpPercentageBar_Click" Width="25" Margin="0,0,2,0" ToolTip="Pick HP Bar Area"/>
                            <Rectangle x:Name="HpPercentageColorDisplay" Width="20" Height="16" Fill="#100CFF" Stroke="#555" StrokeThickness="1" Margin="2,0"/>
                        </StackPanel>
                    </Grid>
                    
                    <!-- MP Percentage Bar -->
                    <Grid Margin="0,0,0,3">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="30"/>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <TextBlock Grid.Column="0" Text="💙MP:" Style="{StaticResource LabelStyle}" VerticalAlignment="Center" FontWeight="Bold" Foreground="#4FC3F7"/>
                        <TextBox Grid.Column="1" x:Name="MpPercentageStartX" Style="{StaticResource CoordTextBoxStyle}" Text="100" ToolTip="MP Bar Start X"/>
                        <TextBox Grid.Column="2" x:Name="MpPercentageEndX" Style="{StaticResource CoordTextBoxStyle}" Text="250" ToolTip="MP Bar End X"/>
                        <TextBox Grid.Column="3" x:Name="MpPercentageY" Style="{StaticResource CoordTextBoxStyle}" Text="84" ToolTip="MP Bar Y"/>
                        <TextBox Grid.Column="4" x:Name="MpPercentageThreshold" Style="{StaticResource CoordTextBoxStyle}" Text="50" ToolTip="Trigger below this %"/>
                        <TextBox Grid.Column="5" x:Name="MpPercentageTolerance" Style="{StaticResource CoordTextBoxStyle}" Text="30" ToolTip="Color tolerance"/>
                        <StackPanel Grid.Column="6" Orientation="Horizontal" Margin="5,0,0,0">
                            <Button Content="📏" Style="{StaticResource SmallButtonStyle}" Click="PickMpPercentageBar_Click" Width="25" Margin="0,0,2,0" ToolTip="Pick MP Bar Area"/>
                            <Rectangle x:Name="MpPercentageColorDisplay" Width="20" Height="16" Fill="#FF4D17" Stroke="#555" StrokeThickness="1" Margin="2,0"/>
                        </StackPanel>
                    </Grid>
                    
                    <!-- Python-style Potion Click Coordinates -->
                    <Grid Margin="0,5,0,3">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="30"/>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="50"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <TextBlock Grid.Column="0" Text="🧪HP:" Style="{StaticResource LabelStyle}" VerticalAlignment="Center" FontWeight="Bold" Foreground="#FF6B6B"/>
                        <TextBox Grid.Column="1" x:Name="PythonHpPotionX" Style="{StaticResource CoordTextBoxStyle}" Text="400" ToolTip="HP Potion Click X"/>
                        <TextBox Grid.Column="2" x:Name="PythonHpPotionY" Style="{StaticResource CoordTextBoxStyle}" Text="300" ToolTip="HP Potion Click Y"/>
                        <TextBox Grid.Column="3" x:Name="PythonHpPotionCooldown" Style="{StaticResource CoordTextBoxStyle}" Text="500" ToolTip="Cooldown ms"/>
                        <Button Grid.Column="4" Content="📍 Pick HP Potion" Style="{StaticResource SmallButtonStyle}" Click="PickPythonHpPotion_Click" HorizontalAlignment="Left" Width="90" Margin="5,0,0,0"/>
                    </Grid>
                    
                    <Grid Margin="0,0,0,3">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="30"/>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="50"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <TextBlock Grid.Column="0" Text="💉MP:" Style="{StaticResource LabelStyle}" VerticalAlignment="Center" FontWeight="Bold" Foreground="#4FC3F7"/>
                        <TextBox Grid.Column="1" x:Name="PythonMpPotionX" Style="{StaticResource CoordTextBoxStyle}" Text="450" ToolTip="MP Potion Click X"/>
                        <TextBox Grid.Column="2" x:Name="PythonMpPotionY" Style="{StaticResource CoordTextBoxStyle}" Text="350" ToolTip="MP Potion Click Y"/>
                        <TextBox Grid.Column="3" x:Name="PythonMpPotionCooldown" Style="{StaticResource CoordTextBoxStyle}" Text="500" ToolTip="Cooldown ms"/>
                        <Button Grid.Column="4" Content="📍 Pick MP Potion" Style="{StaticResource SmallButtonStyle}" Click="PickPythonMpPotion_Click" HorizontalAlignment="Left" Width="90" Margin="5,0,0,0"/>
                    </Grid>
                    
                    <!-- Current Status Display -->
                    <Grid Margin="0,5,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="60"/>
                            <ColumnDefinition Width="60"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <StackPanel Grid.Column="0">
                            <TextBlock Text="HP Status" Style="{StaticResource LabelStyle}" FontSize="8"/>
                            <TextBlock x:Name="HpPercentageStatus" Text="100%" Style="{StaticResource ValueStyle}" FontSize="10" Foreground="#90EE90"/>
                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                <Rectangle x:Name="HpCurrentColorDisplay" Width="12" Height="12" Fill="#000000" Stroke="#555" StrokeThickness="1" Margin="0,0,2,0"/>
                                <TextBlock x:Name="HpCurrentColorText" Text="0,0,0" Style="{StaticResource ValueStyle}" FontSize="7" Foreground="#888"/>
                            </StackPanel>
                        </StackPanel>
                        
                        <StackPanel Grid.Column="1">
                            <TextBlock Text="MP Status" Style="{StaticResource LabelStyle}" FontSize="8"/>
                            <TextBlock x:Name="MpPercentageStatus" Text="100%" Style="{StaticResource ValueStyle}" FontSize="10" Foreground="#87CEEB"/>
                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                <Rectangle x:Name="MpCurrentColorDisplay" Width="12" Height="12" Fill="#000000" Stroke="#555" StrokeThickness="1" Margin="0,0,2,0"/>
                                <TextBlock x:Name="MpCurrentColorText" Text="0,0,0" Style="{StaticResource ValueStyle}" FontSize="7" Foreground="#888"/>
                            </StackPanel>
                        </StackPanel>
                        
                        <StackPanel Grid.Column="2">
                            <TextBlock Text="Monitor Position" Style="{StaticResource LabelStyle}" FontSize="8"/>
                            <TextBlock x:Name="PercentageMonitorPosition" Text="X: 175 (50%)" Style="{StaticResource ValueStyle}" FontSize="8" Foreground="#FFD700"/>
                            <StackPanel Orientation="Horizontal" Margin="0,3">
                                <Button Content="🎨 Capture Current Colors" Style="{StaticResource SmallButtonStyle}" Click="CaptureCurrentColors_Click" FontSize="8" Height="18" Padding="2" Margin="0,0,3,0"/>
                                <Button Content="🔍 Find HP/MP" Style="{StaticResource SmallButtonStyle}" Click="FindHpMpBars_Click" FontSize="8" Height="18" Padding="2"/>
                            </StackPanel>
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </Border>
            
            <!-- BabeBot Style HP/MP System -->
            <Border Background="#2d1b3d" CornerRadius="3" Padding="6" Margin="0,0,0,5">
                <StackPanel>
                    <TextBlock Text="🤖 BabeBot Style HP/MP %" Style="{StaticResource SectionHeaderStyle}" FontSize="11" Margin="0,0,0,5" Foreground="#DA70D6"/>
                    
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <!-- HP Section -->
                        <StackPanel Grid.Column="0" Margin="0,0,5,0">
                            <TextBlock Text="🩸 HP Monitor" Style="{StaticResource SectionHeaderStyle}" FontSize="9" Margin="0,0,0,3" Foreground="#FF6B6B"/>
                            
                            <!-- HP Bar Coordinates -->
                            <Grid Margin="0,0,0,2">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="30"/>
                                    <ColumnDefinition Width="40"/>
                                    <ColumnDefinition Width="40"/>
                                    <ColumnDefinition Width="30"/>
                                </Grid.ColumnDefinitions>
                                
                                <TextBlock Grid.Column="0" Text="Bar:" Style="{StaticResource LabelStyle}" VerticalAlignment="Center" FontSize="8"/>
                                <TextBox Grid.Column="1" x:Name="BabeBotHpStart" Style="{StaticResource CoordTextBoxStyle}" Text="1" ToolTip="Start X" Width="35"/>
                                <TextBox Grid.Column="2" x:Name="BabeBotHpEnd" Style="{StaticResource CoordTextBoxStyle}" Text="90" ToolTip="End X" Width="35"/>
                                <TextBox Grid.Column="3" x:Name="BabeBotHpY" Style="{StaticResource CoordTextBoxStyle}" Text="5" ToolTip="Y Position" Width="25"/>
                            </Grid>
                            
                            <!-- HP Threshold and Potion -->
                            <Grid Margin="0,0,0,2">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="30"/>
                                    <ColumnDefinition Width="40"/>
                                    <ColumnDefinition Width="35"/>
                                    <ColumnDefinition Width="35"/>
                                </Grid.ColumnDefinitions>
                                
                                <TextBlock Grid.Column="0" Text="%:" Style="{StaticResource LabelStyle}" VerticalAlignment="Center" FontSize="8"/>
                                <ComboBox Grid.Column="1" x:Name="BabeBotHpThreshold" FontSize="8" Height="20">
                                    <ComboBoxItem Content="5" />
                                    <ComboBoxItem Content="10" />
                                    <ComboBoxItem Content="15" />
                                    <ComboBoxItem Content="20" />
                                    <ComboBoxItem Content="25" />
                                    <ComboBoxItem Content="30" />
                                    <ComboBoxItem Content="35" />
                                    <ComboBoxItem Content="40" />
                                    <ComboBoxItem Content="45" />
                                    <ComboBoxItem Content="50" />
                                    <ComboBoxItem Content="55" />
                                    <ComboBoxItem Content="60" />
                                    <ComboBoxItem Content="65" />
                                    <ComboBoxItem Content="70" />
                                    <ComboBoxItem Content="75" />
                                    <ComboBoxItem Content="80" />
                                    <ComboBoxItem Content="85" />
                                    <ComboBoxItem Content="90" IsSelected="True"/>
                                    <ComboBoxItem Content="95" />
                                </ComboBox>
                                <TextBox Grid.Column="2" x:Name="BabeBotHpPotionX" Style="{StaticResource CoordTextBoxStyle}" Text="376" ToolTip="HP Potion X" Width="25"/>
                                <TextBox Grid.Column="3" x:Name="BabeBotHpPotionY" Style="{StaticResource CoordTextBoxStyle}" Text="236" ToolTip="HP Potion Y" Width="25"/>
                            </Grid>
                            
                            <!-- HP Controls -->
                            <Grid Margin="0,0,0,3">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="15"/>
                                    <ColumnDefinition Width="40"/>
                                    <ColumnDefinition Width="40"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <CheckBox Grid.Column="0" x:Name="BabeBotHpEnabled" IsChecked="False" VerticalAlignment="Center" Visibility="Collapsed"/>
                                <Button Grid.Column="1" x:Name="BabeBotHpCalibrate" Content="📊 Cal" Style="{StaticResource SmallButtonStyle}" Click="BabeBotHpCalibrate_Click" FontSize="8" Height="20" Grid.ColumnSpan="2" Margin="15,0,0,0"/>
                                <Button Grid.Column="3" Content="📍" Style="{StaticResource SmallButtonStyle}" Click="PickBabeBotHpPotion_Click" Width="25" HorizontalAlignment="Left" Margin="3,0,0,0"/>
                            </Grid>
                            
                            <!-- HP Status -->
                            <StackPanel Margin="0,0,0,0">
                                <StackPanel Orientation="Horizontal" Margin="0,1">
                                    <Rectangle x:Name="BabeBotHpCurrentColor" Width="116" Height="15" Fill="#000000" Stroke="#555" StrokeThickness="1" Margin="0,0,3,0"/>
                                    <TextBlock x:Name="BabeBotHpCurrentText" Text="0,0,0" Style="{StaticResource ValueStyle}" FontSize="7" VerticalAlignment="Center"/>
                                </StackPanel>
                                <TextBlock x:Name="BabeBotHpStatus" Text="--" Style="{StaticResource ValueStyle}" FontSize="8" Foreground="#90EE90"/>
                            </StackPanel>
                        </StackPanel>
                        
                        <!-- MP Section -->
                        <StackPanel Grid.Column="1" Margin="5,0,0,0">
                            <TextBlock Text="💙 MP Monitor" Style="{StaticResource SectionHeaderStyle}" FontSize="9" Margin="0,0,0,3" Foreground="#4FC3F7"/>
                            
                            <!-- MP Bar Coordinates -->
                            <Grid Margin="0,0,0,2">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="30"/>
                                    <ColumnDefinition Width="40"/>
                                    <ColumnDefinition Width="40"/>
                                    <ColumnDefinition Width="30"/>
                                </Grid.ColumnDefinitions>
                                
                                <TextBlock Grid.Column="0" Text="Bar:" Style="{StaticResource LabelStyle}" VerticalAlignment="Center" FontSize="8"/>
                                <TextBox Grid.Column="1" x:Name="BabeBotMpStart" Style="{StaticResource CoordTextBoxStyle}" Text="1" ToolTip="Start X" Width="35"/>
                                <TextBox Grid.Column="2" x:Name="BabeBotMpEnd" Style="{StaticResource CoordTextBoxStyle}" Text="90" ToolTip="End X" Width="35"/>
                                <TextBox Grid.Column="3" x:Name="BabeBotMpY" Style="{StaticResource CoordTextBoxStyle}" Text="12" ToolTip="Y Position" Width="25"/>
                            </Grid>
                            
                            <!-- MP Threshold and Potion -->
                            <Grid Margin="0,0,0,2">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="30"/>
                                    <ColumnDefinition Width="40"/>
                                    <ColumnDefinition Width="35"/>
                                    <ColumnDefinition Width="35"/>
                                </Grid.ColumnDefinitions>
                                
                                <TextBlock Grid.Column="0" Text="%:" Style="{StaticResource LabelStyle}" VerticalAlignment="Center" FontSize="8"/>
                                <ComboBox Grid.Column="1" x:Name="BabeBotMpThreshold" FontSize="8" Height="20">
                                    <ComboBoxItem Content="5" />
                                    <ComboBoxItem Content="10" />
                                    <ComboBoxItem Content="15" />
                                    <ComboBoxItem Content="20" />
                                    <ComboBoxItem Content="25" />
                                    <ComboBoxItem Content="30" />
                                    <ComboBoxItem Content="35" />
                                    <ComboBoxItem Content="40" />
                                    <ComboBoxItem Content="45" />
                                    <ComboBoxItem Content="50" />
                                    <ComboBoxItem Content="55" />
                                    <ComboBoxItem Content="60" />
                                    <ComboBoxItem Content="65" />
                                    <ComboBoxItem Content="70" />
                                    <ComboBoxItem Content="75" />
                                    <ComboBoxItem Content="80" />
                                    <ComboBoxItem Content="85" />
                                    <ComboBoxItem Content="90" IsSelected="True"/>
                                    <ComboBoxItem Content="95" />
                                </ComboBox>
                                <TextBox Grid.Column="2" x:Name="BabeBotMpPotionX" Style="{StaticResource CoordTextBoxStyle}" Text="376" ToolTip="MP Potion X" Width="25"/>
                                <TextBox Grid.Column="3" x:Name="BabeBotMpPotionY" Style="{StaticResource CoordTextBoxStyle}" Text="200" ToolTip="MP Potion Y" Width="25"/>
                            </Grid>
                            
                            <!-- MP Controls -->
                            <Grid Margin="0,0,0,3">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="15"/>
                                    <ColumnDefinition Width="40"/>
                                    <ColumnDefinition Width="40"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <CheckBox Grid.Column="0" x:Name="BabeBotMpEnabled" IsChecked="False" VerticalAlignment="Center" Visibility="Collapsed"/>
                                <Button Grid.Column="1" x:Name="BabeBotMpCalibrate" Content="📊 Cal" Style="{StaticResource SmallButtonStyle}" Click="BabeBotMpCalibrate_Click" FontSize="8" Height="20" Grid.ColumnSpan="2" Margin="15,0,0,0"/>
                                <Button Grid.Column="3" Content="📍" Style="{StaticResource SmallButtonStyle}" Click="PickBabeBotMpPotion_Click" Width="25" HorizontalAlignment="Left" Margin="3,0,0,0"/>
                            </Grid>
                            
                            <!-- MP Status -->
                            <StackPanel Margin="0,0,0,0">
                                <StackPanel Orientation="Horizontal" Margin="0,1">
                                    <Rectangle x:Name="BabeBotMpCurrentColor" Width="118" Height="15" Fill="#000000" Stroke="#555" StrokeThickness="1" Margin="0,0,3,0"/>
                                    <TextBlock x:Name="BabeBotMpCurrentText" Text="0,0,0" Style="{StaticResource ValueStyle}" FontSize="7" VerticalAlignment="Center"/>
                                </StackPanel>
                                <TextBlock x:Name="BabeBotMpStatus" Text="--" Style="{StaticResource ValueStyle}" FontSize="8" Foreground="#87CEEB"/>
                            </StackPanel>
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </Border>
            
            <!-- Periodic Clicks Section -->
            <Border Background="#1a1a1a" CornerRadius="3" Padding="6" Margin="0,0,0,5">
                <StackPanel>
                    <TextBlock Text="⏰ Periodic Clicks" Style="{StaticResource SectionHeaderStyle}" FontSize="11" Margin="0,0,0,3"/>
                    
                    <!-- Main Y Click -->
                    <Grid Margin="0,0,0,3">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="15"/>
                            <ColumnDefinition Width="25"/>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="50"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <CheckBox Grid.Column="0" x:Name="YClickEnabled" IsChecked="True" VerticalAlignment="Center"/>
                        <TextBlock Grid.Column="1" Text="Y:" Style="{StaticResource LabelStyle}" VerticalAlignment="Center" FontWeight="Bold" Foreground="#FFD700"/>
                        <TextBox Grid.Column="2" x:Name="YClickX" Style="{StaticResource CoordTextBoxStyle}" Text="540"/>
                        <TextBox Grid.Column="3" x:Name="YClickY" Style="{StaticResource CoordTextBoxStyle}" Text="760"/>
                        <TextBox Grid.Column="4" x:Name="YClickPeriod" Style="{StaticResource CoordTextBoxStyle}" Text="120" ToolTip="Period in ms"/>
                        <Button Grid.Column="5" Content="📍" Style="{StaticResource SmallButtonStyle}" Click="PickYCoord_Click" HorizontalAlignment="Left" Width="25" Margin="5,0,0,0"/>
                    </Grid>
                    
                    <!-- Extra Clicks -->
                    <Grid Margin="0,0,0,2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="15"/>
                            <ColumnDefinition Width="25"/>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="50"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <CheckBox Grid.Column="0" x:Name="Extra1Enabled" VerticalAlignment="Center"/>
                        <TextBlock Grid.Column="1" Text="E1:" Style="{StaticResource LabelStyle}" VerticalAlignment="Center"/>
                        <TextBox Grid.Column="2" x:Name="Extra1X" Style="{StaticResource CoordTextBoxStyle}" Text="700"/>
                        <TextBox Grid.Column="3" x:Name="Extra1Y" Style="{StaticResource CoordTextBoxStyle}" Text="820"/>
                        <TextBox Grid.Column="4" x:Name="Extra1Period" Style="{StaticResource CoordTextBoxStyle}" Text="250"/>
                        <Button Grid.Column="5" Content="📍" Style="{StaticResource SmallButtonStyle}" Click="PickExtra1Coord_Click" HorizontalAlignment="Left" Width="25" Margin="5,0,0,0"/>
                    </Grid>
                    
                    <Grid Margin="0,0,0,2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="15"/>
                            <ColumnDefinition Width="25"/>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="50"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <CheckBox Grid.Column="0" x:Name="Extra2Enabled" VerticalAlignment="Center"/>
                        <TextBlock Grid.Column="1" Text="E2:" Style="{StaticResource LabelStyle}" VerticalAlignment="Center"/>
                        <TextBox Grid.Column="2" x:Name="Extra2X" Style="{StaticResource CoordTextBoxStyle}" Text="720"/>
                        <TextBox Grid.Column="3" x:Name="Extra2Y" Style="{StaticResource CoordTextBoxStyle}" Text="840"/>
                        <TextBox Grid.Column="4" x:Name="Extra2Period" Style="{StaticResource CoordTextBoxStyle}" Text="500"/>
                        <Button Grid.Column="5" Content="📍" Style="{StaticResource SmallButtonStyle}" Click="PickExtra2Coord_Click" HorizontalAlignment="Left" Width="25" Margin="5,0,0,0"/>
                    </Grid>
                    
                    <Grid Margin="0,0,0,2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="15"/>
                            <ColumnDefinition Width="25"/>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="45"/>
                            <ColumnDefinition Width="50"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <CheckBox Grid.Column="0" x:Name="Extra3Enabled" VerticalAlignment="Center"/>
                        <TextBlock Grid.Column="1" Text="E3:" Style="{StaticResource LabelStyle}" VerticalAlignment="Center"/>
                        <TextBox Grid.Column="2" x:Name="Extra3X" Style="{StaticResource CoordTextBoxStyle}" Text="740"/>
                        <TextBox Grid.Column="3" x:Name="Extra3Y" Style="{StaticResource CoordTextBoxStyle}" Text="860"/>
                        <TextBox Grid.Column="4" x:Name="Extra3Period" Style="{StaticResource CoordTextBoxStyle}" Text="1000"/>
                        <Button Grid.Column="5" Content="📍" Style="{StaticResource SmallButtonStyle}" Click="PickExtra3Coord_Click" HorizontalAlignment="Left" Width="25" Margin="5,0,0,0"/>
                    </Grid>
                </StackPanel>
            </Border>
            
            <!-- Statistics -->
            <Border Background="#1a1a1a" CornerRadius="3" Padding="6">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <StackPanel Grid.Column="0">
                        <TextBlock Text="FPS" Style="{StaticResource LabelStyle}"/>
                        <TextBlock x:Name="FpsValue" Text="0.0" Style="{StaticResource ValueStyle}"/>
                    </StackPanel>
                    
                    <StackPanel Grid.Column="1">
                        <TextBlock Text="Clicks" Style="{StaticResource LabelStyle}"/>
                        <TextBlock x:Name="ClicksValue" Text="0" Style="{StaticResource ValueStyle}"/>
                    </StackPanel>
                    
                    <StackPanel Grid.Column="2">
                        <TextBlock Text="Triggers" Style="{StaticResource LabelStyle}"/>
                        <TextBlock x:Name="TriggersValue" Text="0" Style="{StaticResource ValueStyle}"/>
                    </StackPanel>
                </Grid>
            </Border>
            
            <!-- Action Buttons -->
            <StackPanel Orientation="Horizontal" Margin="0,5,0,0">
                <Button Content="▶️ Start" x:Name="StartButton" Style="{StaticResource SmallButtonStyle}" Click="StartClient_Click" Width="45" Margin="0,0,3,0"/>
                <Button Content="⏸️ Stop" x:Name="StopButton" Style="{StaticResource SmallButtonStyle}" Click="StopClient_Click" Width="40" Margin="0,0,3,0" IsEnabled="False"/>
                <Button Content="🔄 Test" Style="{StaticResource SmallButtonStyle}" Click="TestClient_Click" Width="80"/>
            </StackPanel>
                </StackPanel>
            </TabItem>
            
            <TabItem Header="🎭 Party Heal">
                <StackPanel>
                    <!-- Multi HP Header -->
                    <Grid Margin="0,0,0,8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <TextBlock Grid.Column="0" Text="🎭 Party Heal System" Style="{StaticResource SectionHeaderStyle}" FontSize="12" Foreground="#FF6B6B"/>
                        <CheckBox Grid.Column="1" x:Name="MultiHpEnabled" Content="Enable" IsChecked="False" Foreground="#cccccc" FontSize="9"/>
                    </Grid>
                    
                    <!-- Global Settings -->
                    <Border Background="#1a1a1a" CornerRadius="3" Padding="6" Margin="0,0,0,5">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="60"/>
                                <ColumnDefinition Width="60"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Animation Delay" Style="{StaticResource LabelStyle}" FontSize="9"/>
                                <TextBox x:Name="AnimationDelay" Style="{StaticResource CoordTextBoxStyle}" Text="1500" ToolTip="Skill animation wait time in ms"/>
                            </StackPanel>
                            
                            <StackPanel Grid.Column="1" Margin="5,0,0,0">
                                <TextBlock Text="Check Interval" Style="{StaticResource LabelStyle}" FontSize="9"/>
                                <TextBox x:Name="MultiHpCheckInterval" Style="{StaticResource CoordTextBoxStyle}" Text="100" ToolTip="HP check interval in ms"/>
                            </StackPanel>
                            
                            <StackPanel Grid.Column="2" Margin="10,0,0,0">
                                <Button Content="🎯 Start Multi HP Monitor" x:Name="StartMultiHpButton" Style="{StaticResource SmallButtonStyle}" Click="StartMultiHp_Click" Height="22"/>
                                <Button Content="⏸️ Stop Multi HP Monitor" x:Name="StopMultiHpButton" Style="{StaticResource SmallButtonStyle}" Click="StopMultiHp_Click" Height="22" Margin="0,2,0,0" IsEnabled="False"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                    
                    <!-- Multi HP Monitors -->
                    <ScrollViewer Height="400" VerticalScrollBarVisibility="Auto">
                        <StackPanel x:Name="MultiHpContainer">
                            <!-- HP Monitor 1 -->
                            <Border Background="#2d1b3d" CornerRadius="3" Padding="6" Margin="0,0,0,3">
                                <StackPanel>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="15"/>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <CheckBox Grid.Column="0" x:Name="MultiHp1Enabled" IsChecked="False" VerticalAlignment="Center"/>
                                        <TextBlock Grid.Column="1" Text="🩸 Party Member 1" Style="{StaticResource SectionHeaderStyle}" FontSize="10" Foreground="#FF6B6B"/>
                                        <TextBlock Grid.Column="2" x:Name="MultiHp1Status" Text="Waiting..." Style="{StaticResource ValueStyle}" FontSize="9" HorizontalAlignment="Right" Foreground="#90EE90"/>
                                    </Grid>
                                    
                                    <Grid Margin="0,3,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="50"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <TextBox Grid.Column="0" x:Name="MultiHp1StartX" Style="{StaticResource CoordTextBoxStyle}" Text="1" ToolTip="HP Bar Start X" Width="35"/>
                                        <TextBox Grid.Column="1" x:Name="MultiHp1EndX" Style="{StaticResource CoordTextBoxStyle}" Text="90" ToolTip="HP Bar End X" Width="35"/>
                                        <TextBox Grid.Column="2" x:Name="MultiHp1Y" Style="{StaticResource CoordTextBoxStyle}" Text="5" ToolTip="HP Bar Y" Width="35"/>
                                        <ComboBox Grid.Column="3" x:Name="MultiHp1Threshold" FontSize="8" Height="20" Width="35">
                                            <ComboBoxItem Content="10"/>
                                            <ComboBoxItem Content="20"/>
                                            <ComboBoxItem Content="30" IsSelected="True"/>
                                            <ComboBoxItem Content="40"/>
                                            <ComboBoxItem Content="50"/>
                                            <ComboBoxItem Content="60"/>
                                            <ComboBoxItem Content="70"/>
                                            <ComboBoxItem Content="80"/>
                                            <ComboBoxItem Content="90"/>
                                        </ComboBox>
                                        <TextBox Grid.Column="4" x:Name="MultiHp1ClickX" Style="{StaticResource CoordTextBoxStyle}" Text="376" ToolTip="Click X" Width="35"/>
                                        <TextBox Grid.Column="5" x:Name="MultiHp1ClickY" Style="{StaticResource CoordTextBoxStyle}" Text="236" ToolTip="Click Y" Width="35"/>
                                        <ComboBox Grid.Column="6" x:Name="MultiHp1Key" FontSize="8" Height="20" Width="45">
                                            <ComboBoxItem Content="0"/>
                                            <ComboBoxItem Content="1" IsSelected="True"/>
                                            <ComboBoxItem Content="2"/>
                                            <ComboBoxItem Content="3"/>
                                            <ComboBoxItem Content="4"/>
                                            <ComboBoxItem Content="5"/>
                                            <ComboBoxItem Content="6"/>
                                            <ComboBoxItem Content="7"/>
                                            <ComboBoxItem Content="8"/>
                                            <ComboBoxItem Content="9"/>
                                        </ComboBox>
                                        <StackPanel Grid.Column="7" Orientation="Horizontal" Margin="5,0,0,0">
                                            <Button Content="📊" Style="{StaticResource SmallButtonStyle}" Click="CalibrateMultiHp1_Click" Width="20" Margin="0,0,2,0" ToolTip="Calibrate"/>
                                            <Button Content="📍" Style="{StaticResource SmallButtonStyle}" Click="PickMultiHp1Click_Click" Width="20" ToolTip="Pick Click Position"/>
                                        </StackPanel>
                                    </Grid>
                                    
                                    <!-- HP Status Bar -->
                                    <StackPanel Orientation="Horizontal" Margin="0,3,0,0">
                                        <Rectangle x:Name="MultiHp1ColorBar" Width="180" Height="12" Fill="#000000" Stroke="#555" StrokeThickness="1" Margin="0,0,5,0"/>
                                        <TextBlock x:Name="MultiHp1Percentage" Text="100%" Style="{StaticResource ValueStyle}" FontSize="9" VerticalAlignment="Center" Foreground="#90EE90"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                            
                            <!-- HP Monitors 2-8 (Similar structure) -->
                            <Border Background="#2d1b3d" CornerRadius="3" Padding="6" Margin="0,0,0,3">
                                <StackPanel>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="15"/>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <CheckBox Grid.Column="0" x:Name="MultiHp2Enabled" IsChecked="False" VerticalAlignment="Center"/>
                                        <TextBlock Grid.Column="1" Text="🩸 Party Member 2" Style="{StaticResource SectionHeaderStyle}" FontSize="10" Foreground="#FF6B6B"/>
                                        <TextBlock Grid.Column="2" x:Name="MultiHp2Status" Text="Waiting..." Style="{StaticResource ValueStyle}" FontSize="9" HorizontalAlignment="Right" Foreground="#90EE90"/>
                                    </Grid>
                                    
                                    <Grid Margin="0,3,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="50"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <TextBox Grid.Column="0" x:Name="MultiHp2StartX" Style="{StaticResource CoordTextBoxStyle}" Text="1" Width="35"/>
                                        <TextBox Grid.Column="1" x:Name="MultiHp2EndX" Style="{StaticResource CoordTextBoxStyle}" Text="90" Width="35"/>
                                        <TextBox Grid.Column="2" x:Name="MultiHp2Y" Style="{StaticResource CoordTextBoxStyle}" Text="5" Width="35"/>
                                        <ComboBox Grid.Column="3" x:Name="MultiHp2Threshold" FontSize="8" Height="20" Width="35">
                                            <ComboBoxItem Content="10"/>
                                            <ComboBoxItem Content="20"/>
                                            <ComboBoxItem Content="30" IsSelected="True"/>
                                            <ComboBoxItem Content="40"/>
                                            <ComboBoxItem Content="50"/>
                                            <ComboBoxItem Content="60"/>
                                            <ComboBoxItem Content="70"/>
                                            <ComboBoxItem Content="80"/>
                                            <ComboBoxItem Content="90"/>
                                        </ComboBox>
                                        <TextBox Grid.Column="4" x:Name="MultiHp2ClickX" Style="{StaticResource CoordTextBoxStyle}" Text="376" Width="35"/>
                                        <TextBox Grid.Column="5" x:Name="MultiHp2ClickY" Style="{StaticResource CoordTextBoxStyle}" Text="236" Width="35"/>
                                        <ComboBox Grid.Column="6" x:Name="MultiHp2Key" FontSize="8" Height="20" Width="45">
                                            <ComboBoxItem Content="0"/>
                                            <ComboBoxItem Content="1"/>
                                            <ComboBoxItem Content="2" IsSelected="True"/>
                                            <ComboBoxItem Content="3"/>
                                            <ComboBoxItem Content="4"/>
                                            <ComboBoxItem Content="5"/>
                                            <ComboBoxItem Content="6"/>
                                            <ComboBoxItem Content="7"/>
                                            <ComboBoxItem Content="8"/>
                                            <ComboBoxItem Content="9"/>
                                        </ComboBox>
                                        <StackPanel Grid.Column="7" Orientation="Horizontal" Margin="5,0,0,0">
                                            <Button Content="📊" Style="{StaticResource SmallButtonStyle}" Click="CalibrateMultiHp2_Click" Width="20" Margin="0,0,2,0"/>
                                            <Button Content="📍" Style="{StaticResource SmallButtonStyle}" Click="PickMultiHp2Click_Click" Width="20"/>
                                        </StackPanel>
                                    </Grid>
                                    
                                    <StackPanel Orientation="Horizontal" Margin="0,3,0,0">
                                        <Rectangle x:Name="MultiHp2ColorBar" Width="180" Height="12" Fill="#000000" Stroke="#555" StrokeThickness="1" Margin="0,0,5,0"/>
                                        <TextBlock x:Name="MultiHp2Percentage" Text="100%" Style="{StaticResource ValueStyle}" FontSize="9" VerticalAlignment="Center" Foreground="#90EE90"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                            
                            <!-- HP Monitor 3 -->
                            <Border Background="#2d1b3d" CornerRadius="3" Padding="6" Margin="0,0,0,3">
                                <StackPanel>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="15"/>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <CheckBox Grid.Column="0" x:Name="MultiHp3Enabled" IsChecked="False" VerticalAlignment="Center"/>
                                        <TextBlock Grid.Column="1" Text="🩸 Party Member 3" Style="{StaticResource SectionHeaderStyle}" FontSize="10" Foreground="#FF6B6B"/>
                                        <TextBlock Grid.Column="2" x:Name="MultiHp3Status" Text="Waiting..." Style="{StaticResource ValueStyle}" FontSize="9" HorizontalAlignment="Right" Foreground="#90EE90"/>
                                    </Grid>
                                    
                                    <Grid Margin="0,3,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="50"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <TextBox Grid.Column="0" x:Name="MultiHp3StartX" Style="{StaticResource CoordTextBoxStyle}" Text="1" Width="35"/>
                                        <TextBox Grid.Column="1" x:Name="MultiHp3EndX" Style="{StaticResource CoordTextBoxStyle}" Text="90" Width="35"/>
                                        <TextBox Grid.Column="2" x:Name="MultiHp3Y" Style="{StaticResource CoordTextBoxStyle}" Text="5" Width="35"/>
                                        <ComboBox Grid.Column="3" x:Name="MultiHp3Threshold" FontSize="8" Height="20" Width="35">
                                            <ComboBoxItem Content="10"/>
                                            <ComboBoxItem Content="20"/>
                                            <ComboBoxItem Content="30" IsSelected="True"/>
                                            <ComboBoxItem Content="40"/>
                                            <ComboBoxItem Content="50"/>
                                            <ComboBoxItem Content="60"/>
                                            <ComboBoxItem Content="70"/>
                                            <ComboBoxItem Content="80"/>
                                            <ComboBoxItem Content="90"/>
                                        </ComboBox>
                                        <TextBox Grid.Column="4" x:Name="MultiHp3ClickX" Style="{StaticResource CoordTextBoxStyle}" Text="376" Width="35"/>
                                        <TextBox Grid.Column="5" x:Name="MultiHp3ClickY" Style="{StaticResource CoordTextBoxStyle}" Text="236" Width="35"/>
                                        <ComboBox Grid.Column="6" x:Name="MultiHp3Key" FontSize="8" Height="20" Width="45">
                                            <ComboBoxItem Content="0"/>
                                            <ComboBoxItem Content="1"/>
                                            <ComboBoxItem Content="2"/>
                                            <ComboBoxItem Content="3" IsSelected="True"/>
                                            <ComboBoxItem Content="4"/>
                                            <ComboBoxItem Content="5"/>
                                            <ComboBoxItem Content="6"/>
                                            <ComboBoxItem Content="7"/>
                                            <ComboBoxItem Content="8"/>
                                            <ComboBoxItem Content="9"/>
                                        </ComboBox>
                                        <StackPanel Grid.Column="7" Orientation="Horizontal" Margin="5,0,0,0">
                                            <Button Content="📊" Style="{StaticResource SmallButtonStyle}" Click="CalibrateMultiHp3_Click" Width="20" Margin="0,0,2,0"/>
                                            <Button Content="📍" Style="{StaticResource SmallButtonStyle}" Click="PickMultiHp3Click_Click" Width="20"/>
                                        </StackPanel>
                                    </Grid>
                                    
                                    <StackPanel Orientation="Horizontal" Margin="0,3,0,0">
                                        <Rectangle x:Name="MultiHp3ColorBar" Width="180" Height="12" Fill="#000000" Stroke="#555" StrokeThickness="1" Margin="0,0,5,0"/>
                                        <TextBlock x:Name="MultiHp3Percentage" Text="100%" Style="{StaticResource ValueStyle}" FontSize="9" VerticalAlignment="Center" Foreground="#90EE90"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                            
                            <!-- HP Monitor 4 -->
                            <Border Background="#2d1b3d" CornerRadius="3" Padding="6" Margin="0,0,0,3">
                                <StackPanel>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="15"/>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <CheckBox Grid.Column="0" x:Name="MultiHp4Enabled" IsChecked="False" VerticalAlignment="Center"/>
                                        <TextBlock Grid.Column="1" Text="🩸 Party Member 4" Style="{StaticResource SectionHeaderStyle}" FontSize="10" Foreground="#FF6B6B"/>
                                        <TextBlock Grid.Column="2" x:Name="MultiHp4Status" Text="Waiting..." Style="{StaticResource ValueStyle}" FontSize="9" HorizontalAlignment="Right" Foreground="#90EE90"/>
                                    </Grid>
                                    
                                    <Grid Margin="0,3,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="50"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <TextBox Grid.Column="0" x:Name="MultiHp4StartX" Style="{StaticResource CoordTextBoxStyle}" Text="1" Width="35"/>
                                        <TextBox Grid.Column="1" x:Name="MultiHp4EndX" Style="{StaticResource CoordTextBoxStyle}" Text="90" Width="35"/>
                                        <TextBox Grid.Column="2" x:Name="MultiHp4Y" Style="{StaticResource CoordTextBoxStyle}" Text="5" Width="35"/>
                                        <ComboBox Grid.Column="3" x:Name="MultiHp4Threshold" FontSize="8" Height="20" Width="35">
                                            <ComboBoxItem Content="10"/>
                                            <ComboBoxItem Content="20"/>
                                            <ComboBoxItem Content="30" IsSelected="True"/>
                                            <ComboBoxItem Content="40"/>
                                            <ComboBoxItem Content="50"/>
                                            <ComboBoxItem Content="60"/>
                                            <ComboBoxItem Content="70"/>
                                            <ComboBoxItem Content="80"/>
                                            <ComboBoxItem Content="90"/>
                                        </ComboBox>
                                        <TextBox Grid.Column="4" x:Name="MultiHp4ClickX" Style="{StaticResource CoordTextBoxStyle}" Text="376" Width="35"/>
                                        <TextBox Grid.Column="5" x:Name="MultiHp4ClickY" Style="{StaticResource CoordTextBoxStyle}" Text="236" Width="35"/>
                                        <ComboBox Grid.Column="6" x:Name="MultiHp4Key" FontSize="8" Height="20" Width="45">
                                            <ComboBoxItem Content="0"/>
                                            <ComboBoxItem Content="1"/>
                                            <ComboBoxItem Content="2"/>
                                            <ComboBoxItem Content="3"/>
                                            <ComboBoxItem Content="4" IsSelected="True"/>
                                            <ComboBoxItem Content="5"/>
                                            <ComboBoxItem Content="6"/>
                                            <ComboBoxItem Content="7"/>
                                            <ComboBoxItem Content="8"/>
                                            <ComboBoxItem Content="9"/>
                                        </ComboBox>
                                        <StackPanel Grid.Column="7" Orientation="Horizontal" Margin="5,0,0,0">
                                            <Button Content="📊" Style="{StaticResource SmallButtonStyle}" Click="CalibrateMultiHp4_Click" Width="20" Margin="0,0,2,0"/>
                                            <Button Content="📍" Style="{StaticResource SmallButtonStyle}" Click="PickMultiHp4Click_Click" Width="20"/>
                                        </StackPanel>
                                    </Grid>
                                    
                                    <StackPanel Orientation="Horizontal" Margin="0,3,0,0">
                                        <Rectangle x:Name="MultiHp4ColorBar" Width="180" Height="12" Fill="#000000" Stroke="#555" StrokeThickness="1" Margin="0,0,5,0"/>
                                        <TextBlock x:Name="MultiHp4Percentage" Text="100%" Style="{StaticResource ValueStyle}" FontSize="9" VerticalAlignment="Center" Foreground="#90EE90"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                            
                            <!-- HP Monitor 5 -->
                            <Border Background="#2d1b3d" CornerRadius="3" Padding="6" Margin="0,0,0,3">
                                <StackPanel>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="15"/>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <CheckBox Grid.Column="0" x:Name="MultiHp5Enabled" IsChecked="False" VerticalAlignment="Center"/>
                                        <TextBlock Grid.Column="1" Text="🩸 Party Member 5" Style="{StaticResource SectionHeaderStyle}" FontSize="10" Foreground="#FF6B6B"/>
                                        <TextBlock Grid.Column="2" x:Name="MultiHp5Status" Text="Waiting..." Style="{StaticResource ValueStyle}" FontSize="9" HorizontalAlignment="Right" Foreground="#90EE90"/>
                                    </Grid>
                                    
                                    <Grid Margin="0,3,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="50"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <TextBox Grid.Column="0" x:Name="MultiHp5StartX" Style="{StaticResource CoordTextBoxStyle}" Text="1" Width="35"/>
                                        <TextBox Grid.Column="1" x:Name="MultiHp5EndX" Style="{StaticResource CoordTextBoxStyle}" Text="90" Width="35"/>
                                        <TextBox Grid.Column="2" x:Name="MultiHp5Y" Style="{StaticResource CoordTextBoxStyle}" Text="5" Width="35"/>
                                        <ComboBox Grid.Column="3" x:Name="MultiHp5Threshold" FontSize="8" Height="20" Width="35">
                                            <ComboBoxItem Content="10"/>
                                            <ComboBoxItem Content="20"/>
                                            <ComboBoxItem Content="30" IsSelected="True"/>
                                            <ComboBoxItem Content="40"/>
                                            <ComboBoxItem Content="50"/>
                                            <ComboBoxItem Content="60"/>
                                            <ComboBoxItem Content="70"/>
                                            <ComboBoxItem Content="80"/>
                                            <ComboBoxItem Content="90"/>
                                        </ComboBox>
                                        <TextBox Grid.Column="4" x:Name="MultiHp5ClickX" Style="{StaticResource CoordTextBoxStyle}" Text="376" Width="35"/>
                                        <TextBox Grid.Column="5" x:Name="MultiHp5ClickY" Style="{StaticResource CoordTextBoxStyle}" Text="236" Width="35"/>
                                        <ComboBox Grid.Column="6" x:Name="MultiHp5Key" FontSize="8" Height="20" Width="45">
                                            <ComboBoxItem Content="0"/>
                                            <ComboBoxItem Content="1"/>
                                            <ComboBoxItem Content="2"/>
                                            <ComboBoxItem Content="3"/>
                                            <ComboBoxItem Content="4"/>
                                            <ComboBoxItem Content="5" IsSelected="True"/>
                                            <ComboBoxItem Content="6"/>
                                            <ComboBoxItem Content="7"/>
                                            <ComboBoxItem Content="8"/>
                                            <ComboBoxItem Content="9"/>
                                        </ComboBox>
                                        <StackPanel Grid.Column="7" Orientation="Horizontal" Margin="5,0,0,0">
                                            <Button Content="📊" Style="{StaticResource SmallButtonStyle}" Click="CalibrateMultiHp5_Click" Width="20" Margin="0,0,2,0"/>
                                            <Button Content="📍" Style="{StaticResource SmallButtonStyle}" Click="PickMultiHp5Click_Click" Width="20"/>
                                        </StackPanel>
                                    </Grid>
                                    
                                    <StackPanel Orientation="Horizontal" Margin="0,3,0,0">
                                        <Rectangle x:Name="MultiHp5ColorBar" Width="180" Height="12" Fill="#000000" Stroke="#555" StrokeThickness="1" Margin="0,0,5,0"/>
                                        <TextBlock x:Name="MultiHp5Percentage" Text="100%" Style="{StaticResource ValueStyle}" FontSize="9" VerticalAlignment="Center" Foreground="#90EE90"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                            
                            <!-- HP Monitor 6 -->
                            <Border Background="#2d1b3d" CornerRadius="3" Padding="6" Margin="0,0,0,3">
                                <StackPanel>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="15"/>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <CheckBox Grid.Column="0" x:Name="MultiHp6Enabled" IsChecked="False" VerticalAlignment="Center"/>
                                        <TextBlock Grid.Column="1" Text="🩸 Party Member 6" Style="{StaticResource SectionHeaderStyle}" FontSize="10" Foreground="#FF6B6B"/>
                                        <TextBlock Grid.Column="2" x:Name="MultiHp6Status" Text="Waiting..." Style="{StaticResource ValueStyle}" FontSize="9" HorizontalAlignment="Right" Foreground="#90EE90"/>
                                    </Grid>
                                    
                                    <Grid Margin="0,3,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="50"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <TextBox Grid.Column="0" x:Name="MultiHp6StartX" Style="{StaticResource CoordTextBoxStyle}" Text="1" Width="35"/>
                                        <TextBox Grid.Column="1" x:Name="MultiHp6EndX" Style="{StaticResource CoordTextBoxStyle}" Text="90" Width="35"/>
                                        <TextBox Grid.Column="2" x:Name="MultiHp6Y" Style="{StaticResource CoordTextBoxStyle}" Text="5" Width="35"/>
                                        <ComboBox Grid.Column="3" x:Name="MultiHp6Threshold" FontSize="8" Height="20" Width="35">
                                            <ComboBoxItem Content="10"/>
                                            <ComboBoxItem Content="20"/>
                                            <ComboBoxItem Content="30" IsSelected="True"/>
                                            <ComboBoxItem Content="40"/>
                                            <ComboBoxItem Content="50"/>
                                            <ComboBoxItem Content="60"/>
                                            <ComboBoxItem Content="70"/>
                                            <ComboBoxItem Content="80"/>
                                            <ComboBoxItem Content="90"/>
                                        </ComboBox>
                                        <TextBox Grid.Column="4" x:Name="MultiHp6ClickX" Style="{StaticResource CoordTextBoxStyle}" Text="376" Width="35"/>
                                        <TextBox Grid.Column="5" x:Name="MultiHp6ClickY" Style="{StaticResource CoordTextBoxStyle}" Text="236" Width="35"/>
                                        <ComboBox Grid.Column="6" x:Name="MultiHp6Key" FontSize="8" Height="20" Width="45">
                                            <ComboBoxItem Content="0"/>
                                            <ComboBoxItem Content="1"/>
                                            <ComboBoxItem Content="2"/>
                                            <ComboBoxItem Content="3"/>
                                            <ComboBoxItem Content="4"/>
                                            <ComboBoxItem Content="5"/>
                                            <ComboBoxItem Content="6" IsSelected="True"/>
                                            <ComboBoxItem Content="7"/>
                                            <ComboBoxItem Content="8"/>
                                            <ComboBoxItem Content="9"/>
                                        </ComboBox>
                                        <StackPanel Grid.Column="7" Orientation="Horizontal" Margin="5,0,0,0">
                                            <Button Content="📊" Style="{StaticResource SmallButtonStyle}" Click="CalibrateMultiHp6_Click" Width="20" Margin="0,0,2,0"/>
                                            <Button Content="📍" Style="{StaticResource SmallButtonStyle}" Click="PickMultiHp6Click_Click" Width="20"/>
                                        </StackPanel>
                                    </Grid>
                                    
                                    <StackPanel Orientation="Horizontal" Margin="0,3,0,0">
                                        <Rectangle x:Name="MultiHp6ColorBar" Width="180" Height="12" Fill="#000000" Stroke="#555" StrokeThickness="1" Margin="0,0,5,0"/>
                                        <TextBlock x:Name="MultiHp6Percentage" Text="100%" Style="{StaticResource ValueStyle}" FontSize="9" VerticalAlignment="Center" Foreground="#90EE90"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                            
                            <!-- HP Monitor 7 -->
                            <Border Background="#2d1b3d" CornerRadius="3" Padding="6" Margin="0,0,0,3">
                                <StackPanel>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="15"/>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <CheckBox Grid.Column="0" x:Name="MultiHp7Enabled" IsChecked="False" VerticalAlignment="Center"/>
                                        <TextBlock Grid.Column="1" Text="🩸 Party Member 7" Style="{StaticResource SectionHeaderStyle}" FontSize="10" Foreground="#FF6B6B"/>
                                        <TextBlock Grid.Column="2" x:Name="MultiHp7Status" Text="Waiting..." Style="{StaticResource ValueStyle}" FontSize="9" HorizontalAlignment="Right" Foreground="#90EE90"/>
                                    </Grid>
                                    
                                    <Grid Margin="0,3,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="50"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <TextBox Grid.Column="0" x:Name="MultiHp7StartX" Style="{StaticResource CoordTextBoxStyle}" Text="1" Width="35"/>
                                        <TextBox Grid.Column="1" x:Name="MultiHp7EndX" Style="{StaticResource CoordTextBoxStyle}" Text="90" Width="35"/>
                                        <TextBox Grid.Column="2" x:Name="MultiHp7Y" Style="{StaticResource CoordTextBoxStyle}" Text="5" Width="35"/>
                                        <ComboBox Grid.Column="3" x:Name="MultiHp7Threshold" FontSize="8" Height="20" Width="35">
                                            <ComboBoxItem Content="10"/>
                                            <ComboBoxItem Content="20"/>
                                            <ComboBoxItem Content="30" IsSelected="True"/>
                                            <ComboBoxItem Content="40"/>
                                            <ComboBoxItem Content="50"/>
                                            <ComboBoxItem Content="60"/>
                                            <ComboBoxItem Content="70"/>
                                            <ComboBoxItem Content="80"/>
                                            <ComboBoxItem Content="90"/>
                                        </ComboBox>
                                        <TextBox Grid.Column="4" x:Name="MultiHp7ClickX" Style="{StaticResource CoordTextBoxStyle}" Text="376" Width="35"/>
                                        <TextBox Grid.Column="5" x:Name="MultiHp7ClickY" Style="{StaticResource CoordTextBoxStyle}" Text="236" Width="35"/>
                                        <ComboBox Grid.Column="6" x:Name="MultiHp7Key" FontSize="8" Height="20" Width="45">
                                            <ComboBoxItem Content="0"/>
                                            <ComboBoxItem Content="1"/>
                                            <ComboBoxItem Content="2"/>
                                            <ComboBoxItem Content="3"/>
                                            <ComboBoxItem Content="4"/>
                                            <ComboBoxItem Content="5"/>
                                            <ComboBoxItem Content="6"/>
                                            <ComboBoxItem Content="7" IsSelected="True"/>
                                            <ComboBoxItem Content="8"/>
                                            <ComboBoxItem Content="9"/>
                                        </ComboBox>
                                        <StackPanel Grid.Column="7" Orientation="Horizontal" Margin="5,0,0,0">
                                            <Button Content="📊" Style="{StaticResource SmallButtonStyle}" Click="CalibrateMultiHp7_Click" Width="20" Margin="0,0,2,0"/>
                                            <Button Content="📍" Style="{StaticResource SmallButtonStyle}" Click="PickMultiHp7Click_Click" Width="20"/>
                                        </StackPanel>
                                    </Grid>
                                    
                                    <StackPanel Orientation="Horizontal" Margin="0,3,0,0">
                                        <Rectangle x:Name="MultiHp7ColorBar" Width="180" Height="12" Fill="#000000" Stroke="#555" StrokeThickness="1" Margin="0,0,5,0"/>
                                        <TextBlock x:Name="MultiHp7Percentage" Text="100%" Style="{StaticResource ValueStyle}" FontSize="9" VerticalAlignment="Center" Foreground="#90EE90"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                            
                            <!-- HP Monitor 8 -->
                            <Border Background="#2d1b3d" CornerRadius="3" Padding="6" Margin="0,0,0,3">
                                <StackPanel>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="15"/>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <CheckBox Grid.Column="0" x:Name="MultiHp8Enabled" IsChecked="False" VerticalAlignment="Center"/>
                                        <TextBlock Grid.Column="1" Text="🩸 Party Member 8" Style="{StaticResource SectionHeaderStyle}" FontSize="10" Foreground="#FF6B6B"/>
                                        <TextBlock Grid.Column="2" x:Name="MultiHp8Status" Text="Waiting..." Style="{StaticResource ValueStyle}" FontSize="9" HorizontalAlignment="Right" Foreground="#90EE90"/>
                                    </Grid>
                                    
                                    <Grid Margin="0,3,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="40"/>
                                            <ColumnDefinition Width="50"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <TextBox Grid.Column="0" x:Name="MultiHp8StartX" Style="{StaticResource CoordTextBoxStyle}" Text="1" Width="35"/>
                                        <TextBox Grid.Column="1" x:Name="MultiHp8EndX" Style="{StaticResource CoordTextBoxStyle}" Text="90" Width="35"/>
                                        <TextBox Grid.Column="2" x:Name="MultiHp8Y" Style="{StaticResource CoordTextBoxStyle}" Text="5" Width="35"/>
                                        <ComboBox Grid.Column="3" x:Name="MultiHp8Threshold" FontSize="8" Height="20" Width="35">
                                            <ComboBoxItem Content="10"/>
                                            <ComboBoxItem Content="20"/>
                                            <ComboBoxItem Content="30" IsSelected="True"/>
                                            <ComboBoxItem Content="40"/>
                                            <ComboBoxItem Content="50"/>
                                            <ComboBoxItem Content="60"/>
                                            <ComboBoxItem Content="70"/>
                                            <ComboBoxItem Content="80"/>
                                            <ComboBoxItem Content="90"/>
                                        </ComboBox>
                                        <TextBox Grid.Column="4" x:Name="MultiHp8ClickX" Style="{StaticResource CoordTextBoxStyle}" Text="376" Width="35"/>
                                        <TextBox Grid.Column="5" x:Name="MultiHp8ClickY" Style="{StaticResource CoordTextBoxStyle}" Text="236" Width="35"/>
                                        <ComboBox Grid.Column="6" x:Name="MultiHp8Key" FontSize="8" Height="20" Width="45">
                                            <ComboBoxItem Content="0"/>
                                            <ComboBoxItem Content="1"/>
                                            <ComboBoxItem Content="2"/>
                                            <ComboBoxItem Content="3"/>
                                            <ComboBoxItem Content="4"/>
                                            <ComboBoxItem Content="5"/>
                                            <ComboBoxItem Content="6"/>
                                            <ComboBoxItem Content="7"/>
                                            <ComboBoxItem Content="8" IsSelected="True"/>
                                            <ComboBoxItem Content="9"/>
                                        </ComboBox>
                                        <StackPanel Grid.Column="7" Orientation="Horizontal" Margin="5,0,0,0">
                                            <Button Content="📊" Style="{StaticResource SmallButtonStyle}" Click="CalibrateMultiHp8_Click" Width="20" Margin="0,0,2,0"/>
                                            <Button Content="📍" Style="{StaticResource SmallButtonStyle}" Click="PickMultiHp8Click_Click" Width="20"/>
                                        </StackPanel>
                                    </Grid>
                                    
                                    <StackPanel Orientation="Horizontal" Margin="0,3,0,0">
                                        <Rectangle x:Name="MultiHp8ColorBar" Width="180" Height="12" Fill="#000000" Stroke="#555" StrokeThickness="1" Margin="0,0,5,0"/>
                                        <TextBlock x:Name="MultiHp8Percentage" Text="100%" Style="{StaticResource ValueStyle}" FontSize="9" VerticalAlignment="Center" Foreground="#90EE90"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </StackPanel>
            </TabItem>
        </TabControl>
    </Border>
</UserControl>